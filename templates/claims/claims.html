{% extends 'base.html' %}
{% load staticfiles %}
{% block title %}
  eCS Claims
{% endblock title %}

{% block css %}
  <link type="text/css" href="{% static "css/pnotify.css" %}" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/bootstrap.daterangepicker/2/daterangepicker.css" />
  <style type="text/css">
    #footer {
        padding: 4em 0 6em 0;
        text-align: center;
    }
    #footer .copyright {
        color: #999;
        font-size: 0.9em;
        line-height: 1em;
        margin: 2em 0 0 0;
        padding: 0;
        text-align: center;
    }
    #footer .copyright li {
        display: inline-block;
        list-style: none;
        margin-left: 1em;
        padding-left: 1em;
    }
  </style>
{% endblock css %}

{% block header %}
  <div id="jCrumbs" class="breadCrumb module">
    <ul>
      <li>
        <a href="/logged_in/"><i class="glyphicon glyphicon-home"></i></a>
      </li>
      <li>
        <a href="">Estado de cuenta</a>
      </li>
      <li>
        <a href="">Pendientes</a>
      </li>
    </ul>
  </div>
  <div class="row">
    <div class="12u">
      <section class="box">
        <center><h3>Estado de cuenta Pendientes</h3></center>
        <hr />
        <form action="" class="form-horizontal" method="POST">{% csrf_token %}
          <button style="margin-left:95%;margin-bottom:20px;" type="submit"><i class="fa fa-refresh"></i></button>
          <div class="form-group">
              <label class="col-md-3 control-label">Rango de Fechas</label>
              <div class="col-xs-4">
                <div class="input-icon">
                  <input type="text" name="daterange" class="input-error form-control" value="{{inicio}}-{{fin}}" />
                </div>
              </div>
          </div>
        </form>
        <hr />
        <table cellpadding="0" cellspacing="0" border="0" class="table table-striped table-bordered datatables" id="tabletools">
          <thead>
            <tr>
              <th>Fecha</th>
              <th>Localidad</th>
              <th>Hospital</th>
              <th>Paciente</th>
              <th>Folio</th>
              <th>Total</th>
              <th>Detalle</th>
            </tr>
          </thead>
          <tbody id="tb">
            {% for auth in autorizacion %}
              <tr>
                {% for event in evento %}
                  {% if auth.evento_id == event.id %}
                    <td>{{auth.FechaSolicitud}}</td>
                    {% for pro in proveedor %}
                      {% if pro.id == event.proveedor_id %}
                        <td>{{pro.localidad}}</td>
                        <td>{{pro.hospital}}</td>
                      {% endif %}
                    {% endfor %}                            
                    {% for pa in paciente %}
                      {% if pa.evento_id == event.id %}
                        <td>{{pa.nombre}}</td>
                      {% endif %}
                    {% endfor %}
                    <td>{{event.folioAut}}</td>
                    <td>{{event.total}}</td>
                    <th>
                      <a style="margin-left:0 !important;" class="a-details" href="{{ settings.APP_URL }}/detalles/{{auth.evento_id}}/">
                        <i class="fa fa-eye"></i>
                      </a>
                    </th>
                  {% endif %}
              {% endfor %}  
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </section>
    </div>
  </div>
{% endblock header %}
{% block javascript %}
  <script type="text/javascript" src="{% static "js/pnotify.min.js" %}"></script>
  <script type="text/javascript" src="//cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
  <script type="text/javascript" src="//cdn.jsdelivr.net/bootstrap.daterangepicker/2/daterangepicker.js"></script>
  <script type="text/javascript">
    $(document).ready(function(){
      $('input[name="daterange"]').daterangepicker(
        {
            locale: {
              format: 'YYYY-MM-DD',
              closeText: 'Cerrar',
              prevText: '<Ant',
              nextText: 'Sig>',
              currentText: 'Hoy',
              monthNames: ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'],
              monthNamesShort: ['Ene','Feb','Mar','Abr', 'May','Jun','Jul','Ago','Sep', 'Oct','Nov','Dic'],
              dayNames: ['Domingo', 'Lunes', 'Martes', 'Miércoles', 'Jueves', 'Viernes', 'Sábado'],
              dayNamesShort: ['Dom','Lun','Mar','Mié','Juv','Vie','Sáb'],
              dayNamesMin: ['Do','Lu','Ma','Mi','Ju','Vi','Sá'],
              weekHeader: 'Sm',
              firstDay: 1,
              isRTL: false,
              showMonthAfterYear: false,
              yearSuffix: ''
            },
            startDate: '{{inicio}}',
            endDate: '{{fin}}'
        });
      $('.applyBtn').css('display','none');
      $('.cancelBtn').css('display','none');
    });
  </script>
  {% if bandera == 1 %}
    <script>
      $(document).ready(function(){
        new PNotify({
                title: 'Exito',
                text: 'El reclamo seleccionado se actualizo con exito!',
                type: 'success',
                styling: 'fontawesome'
              });
      });
    </script>
  {% endif %}
  {% if message == 1 %}
    <script>
      $(document).ready(function(){
        new PNotify({
                title: 'Error',
                text: 'No se envio notificación a los usuarios!',
                type: 'error',
                styling: 'fontawesome'
              });
      });
    </script>
  {% endif %}
{% endblock javascript %}