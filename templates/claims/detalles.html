{% extends 'base.html' %}
{% load staticfiles %}
{% block title %}
  eCS Claims
{% endblock title %}

{% block css %}
  <style type="text/css">
    #footer {
        padding: 4em 0 6em 0;
        text-align: center;
    }
    #footer .copyright {
        color: #999;
        font-size: 0.9em;
        line-height: 1em;
        margin: 2em 0 0 0;
        padding: 0;
        text-align: center;
    }
    #footer .copyright li {
        display: inline-block;
        list-style: none;
        margin-left: 1em;
        padding-left: 1em;
    }
    .a-details,.a-details:hover{
      font-size: 30px;
      margin-left: 80%;
      border: none !important;
    }
  </style>
{% endblock css %}

{% block header %}
  <div id="jCrumbs" class="breadCrumb module">
    <ul>
      <li>
        <a href="{{ settings.APP_URL }}/logged_in/"><i class="glyphicon glyphicon-home"></i></a>
      </li>
      <li>
        <a href="">Estado de cuenta</a>
    </li>
    <li>
        <a href="{{ settings.APP_URL }}/claims/">Pendientes</a>
    </li>
    <li>
        <a href="">Detalles</a>
    </li>
    </ul>
  </div>
  <div class="row">
      <div class="12u">
        <div class="12u">
        <div class="text-center">
          <a class="a-details" href="{{ settings.APP_URL }}/claims/">
                <i class="fa fa-long-arrow-left"></i>
          </a>
          <a class="a-details" style="margin-left:50px !important;" id="modal2">
              <img style="width:30px;" src="{% static "images/icon-medical.png" %}">
          </a>
          {% if user.type != TipoUsuario.ECARESOFT %}
            <a style="margin-left:50px !important;" class="a-details" id="modal">
                <i class="fa fa-check-square-o"></i>
            </a>
          {% endif %}
        </div>
      </div>
      <div class="12u">
        <section class="box">      
          
          <ul class="nav nav-tabs">
            <li class="active"><a data-toggle="tab" href="#general">DerechoHabiencia</a></li>
            <li><a data-toggle="tab" href="#evento">Evento</a></li>
            <li><a data-toggle="tab" href="#medicos">Medicos</a></li>
            <li><a data-toggle="tab" href="#diagnosticos">Diagnosticos</a></li>
            <li><a data-toggle="tab" href="#procedimiento">Procedimientos</a></li>
          </ul>

          <div class="tab-content">
            <div id="general" class="tab-pane fade in active">
              <br>
              <form class="form-horizontal">
                <div class="form-group">
                  
                  <label class="col-md-1 control-label">No. Ficha</label>
                  <div class="col-xs-4">
                    <div class="input-icon">
                      <input class="input-error form-control" type="text" value="{{paciente.fichaEmp}}" disabled>
                    </div>
                  </div>
                  <label class="col-md-1 control-label">No. Codificación</label>
                  <div class="col-xs-4">
                    <div class="input-icon">
                      <input class="input-error form-control" type="text" value="{{paciente.numCod}}" disabled>
                    </div>
                  </div>
                </div>
                <div class="form-group">
                  
                  <label class="col-md-1 control-label">Organismo</label>
                  <div class="col-xs-4">
                    <div class="input-icon">
                      <input class="input-error form-control" type="text" value="{{paciente.numEmpresa}}" disabled>
                    </div>
                  </div>
                  <label class="col-md-1 control-label">Folio Autorización</label>
                  <div class="col-xs-4">
                    <div class="input-icon">
                      <input class="input-error form-control" type="text" value="{{detalle.folioAut}}" disabled>
                    </div>
                  </div>
                </div>
                <div class="form-group">
                  
                  <label class="col-md-1 control-label">Nombre Paciente</label>
                  <div class="col-xs-4">
                    <div class="input-icon">
                      <input class="input-error form-control" type="text" value="{{paciente.nombre}}" disabled>
                    </div>
                  </div>
                </div>
              </form>
            </div>
            <div id="evento" class="tab-pane fade">
              <form class="form-horizontal">
                <div class="form-group">
                  <label class="col-md-1 control-label">Evento</label>
                  <div class="col-xs-4">
                    <div class="input-icon">
                      <input class="input-error form-control" type="text" value="{{detalle.numEvento}}" disabled>
                    </div>
                  </div>
                  
                  <label class="col-md-1 control-label">Tipo</label>
                  <div class="col-xs-4">
                    <div class="input-icon">
                      <input class="input-error form-control" type="text" value="{{detalle.get_tipo_display}}" disabled>
                    </div>
                  </div>
                </div>
                <div class="form-group">
                  <label class="col-md-1 control-label">Admisión</label>
                  <div class="col-xs-4">
                    <div class="input-icon">
                      <input class="input-error form-control" type="text" value="{{detalle.fechaAdm}}" disabled>
                    </div>
                  </div>
                  
                  <label class="col-md-1 control-label">Alta</label>
                  <div class="col-xs-4">
                    <div class="input-icon">
                      <input class="input-error form-control" type="text" value="{{detalle.fechaAlta}}" disabled>
                    </div>
                  </div>
                </div>
              </form>
            </div>
            <div id="medicos" class="tab-pane fade">
              <br>
              <table cellpadding="0" cellspacing="0" border="0" class="table table-striped table-bordered datatables" id="tabletools2">
                  <thead>
                    <tr>
                      <th>Tipo</th>
                      <th>Nombre</th>
                      <th>Especialidad</th>
                    </tr>
                  </thead>
                  <tbody id="tb">
                    {% for dato in medico %}
                      <tr>
                        <td>{{dato.tipo}}</td>
                        <td>{{dato.nombre}}</td>
                        <td>{{dato.especialidad}}</td>
                      </tr>
                    {% endfor %}
                  </tbody>
                </table>
            </div>
            <div id="diagnosticos" class="tab-pane fade">
              <div>
                <table cellpadding="0" cellspacing="0" border="0" class="table table-striped table-bordered datatables" id="tabletools2">
                <thead>
                  <tr>
                    <th>Fecha</th>
                    <th>Codigo</th>
                    <th>Descripcion</th>
                    <th>Medico</th>
                    <th>Observacion</th>
                  </tr>
                </thead>
                <tbody id="tb">
                  {% for dato in dx %}
                    <tr>
                      <td>{{dato.fecha}}</td>
                      <td>{{dato.codigo}}</td>
                      <td>{{dato.nombre}}</td>
                      {% for doctor in medico %}
                        {% if doctor.id == dato.medico_id %}
                          <td>{{doctor.nombre}}</td>
                        {% endif %}
                      {% endfor %}
                      <td>{{dato.observaciones}}</td>
                    </tr>
                  {% endfor %}
                </tbody>
              </table>
              </div>
            </div>
            <div id="procedimiento" class="tab-pane fade">
              <div>
                <table cellpadding="0" cellspacing="0" border="0" class="table table-striped table-bordered datatables" id="tabletools2">
                  <thead>
                    <tr>
                      <th>Fecha</th>
                      <th>Codigo</th>
                      <th>Descripcion</th>
                      <th>Medico</th>
                      <th>Observacion</th>
                    </tr>
                  </thead>
                  <tbody id="tb">
                    {% for dato in procedimiento %}
                      <tr>
                        <td>{{dato.fecha}}</td>
                        <td>{{dato.codigo}}</td>
                        <td>{{dato.nombre}}</td>
                        {% for doctor in medico %}
                          {% if doctor.id == dato.medico_id %}
                            <td>{{doctor.nombre}}</td>
                          {% endif %}
                        {% endfor %}
                        <td>{{dato.observaciones}}</td>
                      </tr>
                    {% endfor %}
                  </tbody>
                </table>
              </div>
            </div>
          </div>
          <hr />
          <table cellpadding="0" cellspacing="0" border="0" class="table table-striped table-bordered datatables" id="tabletools">
            <thead>
              <tr>
                <th>Concepto</th>
                <th>Descripción</th>
                <th>Unidad de Medida</th>
                <th>Cantidad</th>
                <th>Precio Unitario</th>
                <th>Descuento</th>
                <th>Precio Neto</th>
                <th>Impuesto</th>
              </tr>
            </thead>
            <tbody id="tb">

              {% for dato in cargo %}
                <tr>
                  <td>{{dato.codigo}}</td>
                  <td>{{dato.descripcion}}</td>
                  <td>{{dato.udm}}</td>
                  <td>{{dato.cantidad}}</td>
                  <td>{{dato.precio}}</td>
                  <td>{{dato.descuento}}</td>
                  <td>{{dato.subtotal}}</td>
                  <td>{{dato.iva}}</td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </section>
      </div>
  </div>
{% endblock header %}

{% block javascript %}
  <script>
    $('#modal').on('click',function(){
      $('#modal-form').modal('show'); 
    });
    $('#modal2').on('click',function(){
      $('#modal-form2').modal('show'); 
    });
    function motivos(value){
      if(value == 'X'){
        $('#motivo').css('display','block');
      }
      else{
        if(value == 'N'){
          $('#motivo').css('display','block');
        }
        else{
          $('#motivo').css('display','none');
        }
      }
    }
  </script>
{% endblock javascript %}

{% block modal %}
  <div class="modal fade" id="modal-form" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog" style="z-index:2000;width:90%;">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
          <h4 class="modal-title" id="myModalLabel">Autorizar</h4>
        </div>
        <form action="" class="form-horizontal" method="POST">{% csrf_token %}
        <div class="modal-body">
          
            <div class="form-group">
               <div class="form-group">
                <label class="col-md-2 control-label">Tipo</label>
                <div class="col-xs-6">
                  <div class="input-icon">
                    {% if user.type == TipoUsuario.MAC %}
                      <select onchange="motivos(this.value);" name="estatus" class="form-control">
                        <option value="Y">Aceptado</option>
                        <option value="N">Rechazado</option>
                        <option value="E">En Revisión</option>
                      </select>
                    {% endif %}
                    {% if user.type == TipoUsuario.PEMEX %}
                      <select onchange="motivos(this.value);" name="estatus" class="form-control">
                        <option value="A">Aceptado</option>
                        <option value="X">Rechazado</option>
                        <option value="P">En Revisión</option>
                      </select>
                    {% endif %}
                  </div>
                </div>
              </div>
              <div style="display:none;" id="motivo" class="form-group">
                <label class="col-md-2 control-label">Motivo</label>
                <div class="col-xs-6">
                  <div class="input-icon">
                    <select name="motivo" class="form-control">
                      <option value=""></option>
                      {% for item in motivo %}
                        <option value="{{item.id}}">{{item.motivo}}</option>
                      {% endfor %}
                    </select>
                  </div>
                </div>
              </div>
              <div class="form-group">
                <label class="col-md-2 control-label">Comentarios</label>
                <div class="col-xs-6">
                  <div class="input-icon">
                    <textarea name="descripcion" class="form-control" rows="6" cols="100"></textarea>
                  </div>
                </div>
              </div>
            </div>
            <input type="hidden" name="id" value="{{idd}}">
        </div>
        <div id="btnmodal" class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
          <input type="submit" class="btn btn-default" value="Actualizar">
        </div>
        </form>
      </div>
    </div>
  </div>
  <div class="modal fade" id="modal-form2" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog" style="z-index:2000;width:90%;">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
          <h4 class="modal-title" id="myModalLabel">CUMULUS</h4>
        </div>
        <div class="modal-body">
          <center>
            <object style="width:1000px;height:500px;" data="https://www.ecs.mx/CumulusWebTest/external.zul?token=b9477321cc9fbce3c1f30ae44e9ff4f2d89e6949&curp={{paciente.curp}}"></object>
          </center>
          
        </div>
      </div>
    </div>
  </div>
{% endblock modal %}