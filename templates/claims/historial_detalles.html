{% extends 'base.html' %}
{% load staticfiles %}
{% block title %}
  eCS Claims
{% endblock title %}

{% block css %}
  <style type="text/css">
    #footer {
        padding: 4em 0 6em 0;
        text-align: center;
    }
    #footer .copyright {
        color: #999;
        font-size: 0.9em;
        line-height: 1em;
        margin: 2em 0 0 0;
        padding: 0;
        text-align: center;
    }
    #footer .copyright li {
        display: inline-block;
        list-style: none;
        margin-left: 1em;
        padding-left: 1em;
    }
    .a-details,.a-details:hover{
      font-size: 30px;
      margin-left: 70%;
      border: none !important;
    }
  </style>
{% endblock css %}

{% block header %}
  <div id="jCrumbs" class="breadCrumb module">
    <ul>
      <li>
        <a href="{{ settings.APP_URL }}/logged_in/"><i class="glyphicon glyphicon-home"></i></a>
      </li>
      <li>
        <a href="">Estado de cuenta</a>
    </li>
    <li>
        <a href="{{ settings.APP_URL }}/claims/">Pendientes</a>
    </li>
    <li>
        <a href="">Detalles</a>
    </li>
    </ul>
  </div>
  <div class="row">
      <div class="12u">
        <div class="12u">
        <div class="text-center">
          <a class="a-details" href="{{ settings.APP_URL }}/historial/">
                <i class="fa fa-long-arrow-left"></i>
          </a>
          <a class="a-details" style="margin-left:5% !important;" id="modal">
                <i class="fa fa-cloud"></i>
          </a>
          <a class="a-details" style="margin-left:5% !important;" id="modal2">
              <img style="width:30px;" src="{% static "images/icon-medical.png" %}">
          </a>
        </div>
      </div>
      <div class="12u">
        <section class="box">      
          
          <ul class="nav nav-tabs">
            <li class="active"><a data-toggle="tab" href="#general">DerechoHabiencia</a></li>
            <li><a data-toggle="tab" href="#evento">Evento</a></li>
            <li><a data-toggle="tab" href="#medicos">Medicos</a></li>
            <li><a data-toggle="tab" href="#diagnosticos">Diagnosticos</a></li>
            <li><a data-toggle="tab" href="#procedimiento">Procedimientos</a></li>
          </ul>

          <div class="tab-content">
            <div id="general" class="tab-pane fade in active">
              <br>
              <form class="form-horizontal">
                <div class="form-group">
                  <label class="col-md-1 control-label">No. Ficha</label>
                  <div class="col-xs-4">
                    <div class="input-icon">
                      <input class="input-error form-control" type="text" value="{{patient.fichaEmp}}" disabled>
                    </div>
                  </div>
                  <label class="col-md-1 control-label">No. Codificación</label>
                  <div class="col-xs-4">
                    <div class="input-icon">
                      <input class="input-error form-control" type="text" value="{{patient.numCod}}" disabled>
                    </div>
                  </div>
                </div>
                <div class="form-group">
                  
                  <label class="col-md-1 control-label">Organismo</label>
                  <div class="col-xs-4">
                    <div class="input-icon">
                      <input class="input-error form-control" type="text" value="{{patient.numEmpresa}}" disabled>
                    </div>
                  </div>
                  <label class="col-md-1 control-label">Folio Medinet</label>
                  <div class="col-xs-4">
                    <div class="input-icon">
                      <input class="input-error form-control" type="text" value="{{detail.folioAut}}" disabled>
                    </div>
                  </div>
                </div>
                <div class="form-group">
                  
                  <label class="col-md-1 control-label">Nombre Paciente</label>
                  <div class="col-xs-4">
                    <div class="input-icon">
                      <input class="input-error form-control" type="text" value="{{patient.curp}}" disabled>
                    </div>
                  </div>
                </div>
              </form>
            </div>
            <div id="evento" class="tab-pane fade">
              <form class="form-horizontal">
                <div class="form-group">
                  <label class="col-md-1 control-label">Evento</label>
                  <div class="col-xs-4">
                    <div class="input-icon">
                      <input class="input-error form-control" type="text" value="{{detail.numEvento}}" disabled>
                    </div>
                  </div>
                  
                  <label class="col-md-1 control-label">Tipo</label>
                  <div class="col-xs-4">
                    <div class="input-icon">
                      <input class="input-error form-control" type="text" value="{{detail.get_tipo_display}}" disabled>
                    </div>
                  </div>
                </div>
                <div class="form-group">
                  <label class="col-md-1 control-label">Admisión</label>
                  <div class="col-xs-4">
                    <div class="input-icon">
                      <input class="input-error form-control" type="text" value="{{detail.fechaAdm}}" disabled>
                    </div>
                  </div>
                  
                  <label class="col-md-1 control-label">Alta</label>
                  <div class="col-xs-4">
                    <div class="input-icon">
                      <input class="input-error form-control" type="text" value="{{detail.fechaAlta}}" disabled>
                    </div>
                  </div>
                </div>
                <div class="form-group">
                  <label class="col-md-1 control-label">Inicio de Captura</label>
                  <div class="col-xs-4">
                    <div class="input-icon">
                      {% if detail.fechaPrimerCargo != Null %}
                          <input class="input-error form-control" type="text" value="{{detail.fechaPrimerCargo}}" disabled>
                      {% else %}
                          <input class="input-error form-control" type="text" value="N/D" disabled>
                      {% endif %}
                    </div>
                  </div>
                  <label class="col-md-1 control-label">Total</label>
                  <div class="col-xs-4">
                    <div class="input-icon">
                      <input class="input-error form-control" type="text" value="{{detail.total}}" disabled>
                    </div>
                  </div>
                </div>
              </form>
            </div>
            <div id="medicos" class="tab-pane fade">
              <br>
              <table cellpadding="0" cellspacing="0" border="0" class="table table-striped table-bordered datatables" id="tabletools2">
                  <thead>
                    <tr>
                      <th>Tipo</th>
                      <th>Nombre</th>
                      <th>Especialidad</th>
                    </tr>
                  </thead>
                  <tbody id="tb">
                    {% for medics in medic %}
                      <tr>
                        <td>{{medics.tipo}}</td>
                        <td>{{medics.nombre}}</td>
                        <td>{{medics.especialidad}}</td>
                      </tr>
                    {% endfor %}
                  </tbody>
                </table>
            </div>
            <div id="diagnosticos" class="tab-pane fade">
              <div>
                <table cellpadding="0" cellspacing="0" border="0" class="table table-striped table-bordered datatables" id="tabletools2">
                <thead>
                  <tr>
                    <th>Fecha</th>
                    <th>Codigo</th>
                    <th>Descripcion</th>
                    <th>Medico</th>
                    <th>Observacion</th>
                  </tr>
                </thead>
                <tbody id="tb">
                  {% for dxs in dx %}
                    <tr>
                      <td>{{dxs.fecha}}</td>
                      <td>{{dxs.codigo}}</td>
                      <td>{{dxs.nombre}}</td>
                      {% for medics in medic %}
                        {% if medics.id == dxs.medico_id %}
                          <td>{{medics.nombre}}</td>
                        {% endif %}
                      {% endfor %}
                      <td>{{dxs.observaciones}}</td>
                    </tr>
                  {% endfor %}
                </tbody>
              </table>
              </div>
            </div>
            <div id="procedimiento" class="tab-pane fade">
              <div>
                <table cellpadding="0" cellspacing="0" border="0" class="table table-striped table-bordered datatables" id="tabletools2">
                  <thead>
                    <tr>
                      <th>Fecha</th>
                      <th>Codigo</th>
                      <th>Descripcion</th>
                      <th>Medico</th>
                      <th>Observacion</th>
                    </tr>
                  </thead>
                  <tbody id="tb">
                    {% for procedures in procedure %}
                      <tr>
                        <td>{{procedures.fecha}}</td>
                        <td>{{procedures.codigo}}</td>
                        <td>{{procedures.nombre}}</td>
                        {% for medics in medic %}
                          {% if medics.id == procedures.medico_id %}
                            <td>{{medics.nombre}}</td>
                          {% endif %}
                        {% endfor %}
                        <td>{{procedures.observaciones}}</td>
                      </tr>
                    {% endfor %}
                  </tbody>
                </table>
              </div>
            </div>
          </div>
          <hr />
          <table cellpadding="0" cellspacing="0" border="0" class="table table-striped table-bordered datatables" id="tabletools">
            <thead>
              <tr>
                <th>Concepto</th>
                <th>Descripción</th>
                <th>Unidad de Medida</th>
                <th>Cantidad</th>
                <th>Precio Unitario</th>
                <th>Descuento</th>
                <th>Precio Neto</th>
                <th>Impuesto</th>
              </tr>
            </thead>
            <tbody id="tb">

              {% for charges in charge %}
                <tr>
                  <td>{{charges.codigo}}</td>
                  <td>{{charges.descripcion}}</td>
                  <td>{{charges.udm}}</td>
                  <td>{{charges.cantidad}}</td>
                  <td>{{charges.precio}}</td>
                  <td>{{charges.descuento}}</td>
                  <td>{{charges.subtotal}}</td>
                  <td>{{charges.iva}}</td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </section>
      </div>
  </div>
{% endblock header %}

{% block javascript %}
  <script>
  $(document).ready(function(){
    var table3 = $('#tabletools3').dataTable({
        "language": {
            "lengthMenu": "_MENU_",
            "sProcessing":     "Procesando...",
            "sZeroRecords":    "No se encontraron resultados",
            "sEmptyTable":     "No existen archivos adjuntos para este Estado de Cuenta",
            "sInfo":           "Mostrando registros del _START_ al _END_ de un total de _TOTAL_ registros",
            "sInfoEmpty":      "Mostrando registros del 0 al 0 de un total de 0 registros",
            "sInfoFiltered":   "(filtrado de un total de _MAX_ registros)",
            "sInfoPostFix":    "",
            "sUrl":            "",
            "sInfoThousands":  ",",
            "sLoadingRecords": "Cargando...",
            "oPaginate": {
                "sFirst":    "Primero",
                "sLast":     "Último",
                "sNext":     "Siguiente",
                "sPrevious": "Anterior"
            },
            "oAria": {
                "sSortAscending":  ": Activar para ordenar la columna de manera ascendente",
                "sSortDescending": ": Activar para ordenar la columna de manera descendente"
            }
        }
      });
      $('.dataTables_filter input').attr('placeholder','Buscar');
      $('#example_length').hide();

      //DOM Manipulation to move datatable elements integrate to panel
      $('.panel-ctrls').append($('.dataTables_filter').addClass("pull-right")).find("label").addClass("panel-ctrls-center");
      $('.panel-ctrls').append("<i class='separator'></i>");
      $('.panel-ctrls').append($('.dataTables_length').addClass("pull-left")).find("label").addClass("panel-ctrls-center");

      $('.dataTables_paginate>ul.pagination').addClass("pull-right m0");
    });
    console.log('{{bug}}');
    $('#modal').on('click',function(){
      $('#modal-form').modal('show'); 
    });
    $('#modal2').on('click',function(){
      $('#modal-form2').modal('show'); 
    });
    function motivos(value){
      if(value == 'X'){
        $('#motivo').css('display','block');
      }
      else{
        if(value == 'N'){
          $('#motivo').css('display','block');
        }
        else{
          $('#motivo').css('display','none');
        }
      }
    }

  </script>
{% endblock javascript %}

{% block modal %}
  <div class="modal fade" id="modal-form" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog" style="z-index:2000;width:90%;">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
          <h4 class="modal-title" id="myModalLabel">ADJUNTOS</h4>
        </div>
        <div class="modal-body">
          <table cellpadding="0" cellspacing="0" border="0" class="table table-striped table-bordered datatables" id="tabletools3">
            <thead>
              <tr>
                <th>Adjunto</th>
                <th>Descargar</th>
              </tr>
            </thead>
            <tbody id="tb">
              {% for attachments in attachment %}
                <tr>
                  <td>{{attachments.nombre}}</td>
                  <td><a href="https://148.244.75.41:6443/eCareSoftWeb/file?uuid={{attachments.uuid}}"><i class="fa fa-eye"></i></a></td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
        <div id="btnmodal" class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
        </div>
      </div>
    </div>
  </div>
  <div class="modal fade" id="modal-form2" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog" style="z-index:2000;width:90%;">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
          <h4 class="modal-title" id="myModalLabel">CUMULUS</h4>
        </div>
        <div class="modal-body">
          <center>
            <object style="width:1000px;height:500px;" data="https://www.ecs.mx/CumulusWebTest/external.zul?token=b9477321cc9fbce3c1f30ae44e9ff4f2d89e6949&curp={{patient.curp}}"></object>
          </center>
          
        </div>
      </div>
    </div>
  </div>
{% endblock modal %}