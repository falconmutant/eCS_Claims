{% extends 'base.html' %}
{% load staticfiles %}
{% block title %}
eCS Claims
{% endblock title %}

{% block css %}
  <link href="{% static "css/font-awesome.css" %}" rel="stylesheet">
  <link rel="stylesheet" href="{% static "admin/bootstrap/css/bootstrap.min.css" %}" />
  <link rel="stylesheet" href="{% static "admin/lib/jquery-ui/css/Aristo/Aristo.css" %}" />
  <link rel="stylesheet" href="{% static "admin/lib/jBreadcrumbs/css/BreadCrumb.css" %}" />
  <link rel="stylesheet" href="{% static "admin/img/font-awesome/css/font-awesome.min.css" %}" />
  <link rel="stylesheet" href="{% static "admin/css/style.css" %}" />
  <link rel="stylesheet" href="{% static "admin/css/blue.css" %}" id="link_theme" />
  <link href='http://fonts.googleapis.com/css?family=PT+Sans' rel='stylesheet' type='text/css'>
  <link href="{% static "datatables/dataTables.css" %}" rel="stylesheet">
  <link href="{% static "datatables/dataTables.bootstrap.css" %}" rel="stylesheet">
  <link href="{% static "datatables/dataTables.fontAwesome.css" %}" rel="stylesheet">
  <style type="text/css">
    #footer {
        padding: 4em 0 6em 0;
        text-align: center;
    }
    #footer .copyright {
        color: #999;
        font-size: 0.9em;
        line-height: 1em;
        margin: 2em 0 0 0;
        padding: 0;
        text-align: center;
    }
    #footer .copyright li {
        display: inline-block;
        list-style: none;
        margin-left: 1em;
        padding-left: 1em;
    }
    .a-details,.a-details:hover{
      font-size: 30px;
      margin-left: 80%;
      border: none !important;
    }
  </style>
{% endblock css %}

{% block header %}
<div id="maincontainer" class="clearfix">
  <header>
    <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="brand pull-left" href="/logged_in/">eCareSoft</a>
          <ul class="nav navbar-nav user_menu pull-right">
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                <img src="{% static "admin/img/user_avatar.png" %}" alt="" class="user_avatar">
                {{nombre}}
                <b class="caret"></b>
              </a>
              <ul class="dropdown-menu dropdown-menu-right">
                <li><a href="/cerrar/">Salir</a></li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </nav>
  </header>
  <div id="contentwrapper">
    <div style="background-image: url({% static "admin/img/bg_c.png" %});" class="main_content">
      <div id="jCrumbs" class="breadCrumb module">
        <ul>
          <li>
            <a href="/logged_in/"><i class="glyphicon glyphicon-home"></i></a>
          </li>
          <li>
            <a href="">Facturas</a>
        </li>
        <li>
            <a href="/invoices/">Pendientes</a>
        </li>
        <li>
            <a href="">Detalles</a>
        </li>
        </ul>
      </div>
      <div class="row">
        <div class="12u">
          <section class="box">
            <a class="a-details" href="/invoice/"><i class="fa fa-long-arrow-left"></i></a>
            <a style="margin-left:60px !important;" class="a-details" id="info-claims"><i class="fa fa-info"></i></a>
            <hr />
            <form id="form" class="form-horizontal">
              <div class="form-group">
                <label class="col-md-2 control-label">Emisor</label>
                <div class="col-xs-2">
                  <div class="input-icon">
                    {% for em in emisor %}
                      {% if em.id == detalle.emisor_id %}
                        <input class="input-error form-control" type="text" value="{{em.nombre}}">
                      {% endif %}
                    {% endfor %}
                  </div>
                </div>
                <label class="col-md-2 control-label">RFC</label>
                <div class="col-xs-2">
                  <div class="input-icon">
                    {% for em in emisor %}
                      {% if em.id == detalle.emisor_id %}
                        <input class="input-error form-control" type="text" value="{{em.rfc}}">
                      {% endif %}
                    {% endfor %}
                  </div>
                </div>
                <label class="col-md-2 control-label">Localidad</label>
                <div class="col-xs-2">
                  <div class="input-icon">
                    {% for em in emisor %}
                      {% if em.id == detalle.emisor_id %}
                        <input class="input-error form-control" type="text" value="{{em.municipio}}">
                      {% endif %}
                    {% endfor %}
                  </div>
                </div>
              </div>
              <div class="form-group">
                <label class="col-md-2 control-label">Total de Factura</label>
                <div class="col-xs-2">
                  <div class="input-icon">
                    <input class="input-error form-control" type="text" value="{{detalle.total}}">
                  </div>
                </div>
              </div>
            </form>
            <hr />
            <table cellpadding="0" cellspacing="0" border="0" class="table table-striped table-bordered datatables" id="tabletools">
              <thead>
                <tr>
                  <th>folio</th>
                  <th>Concepto</th>
                  <th>Cantidad</th>
                  <th>Unidad</th>
                  <th>Descripción</th>
                  <th>Importe</th>
                </tr>
              </thead>
              <tbody id="tb">
                {% for co in conceptos %}
                  {% if co.comprobante_id == detalle.id %}
                        <tr>
                          <td>{{detalle.folio}}</td>
                          <td>{{detalle.fecha}}</td>
                          <td>{{co.cantidad}}</td>
                          <td>{{co.unidad}}</td>
                          <td>{{co.descripcion}}</td>
                          <td>{{co.importe}}</td>
                        </tr>
                  {% endif %}
                {% endfor %}
              </tbody>
            </table>
          </section>
        </div>
      </div>
      <footer id="footer">
        <ul class="copyright">
            <li>&copy; Todos los derechos reservados eCareSoft México.
        </ul>
      </footer>  
    </div>
  </div>
</div>
{% endblock header %}

{% block sidebar %}
<div class="sidebar">
  <div class="sidebar_inner_scroll">
    <div class="sidebar_inner">
      <div id="side_accordion" class="panel-group">
        <div class="panel panel-default">
          <div class="panel-heading">
            <a href="#collapseTwo" data-parent="#side_accordion" data-toggle="collapse" class="accordion-toggle">
              <i class="glyphicon glyphicon-th"></i> Reclamos
            </a>
          </div>
          <div class="accordion-body collapse" id="collapseTwo">
            <div class="panel-body">
              <ul class="nav nav-pills nav-stacked">
                <li><a href="/claims/">Pendientes</a></li>
                <li><a href="/historial/">Historial</a></li>
                <li><a href="/explorer/">Reportes</a></li>
              </ul>
            </div>
          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading">
            <a href="#collapseOne" data-parent="#side_accordion" data-toggle="collapse" class="accordion-toggle">
                <i class="glyphicon glyphicon-th"></i> Facturación
            </a>
          </div>
          <div class="accordion-body collapse" id="collapseOne">
            <div class="panel-body">
              <ul class="nav nav-pills nav-stacked">
                <li><a href="/invoice/">Pendientes</a></li>
                <li><a href="/historial_invoices/">Historial</a></li>
                <li><a href="/explorer/">Reportes</a></li>
              </ul>
            </div>
          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading">
            <a href="#collapseThree" data-parent="#side_accordion" data-toggle="collapse" class="accordion-toggle">
              <i class="glyphicon glyphicon-user"></i> Usuarios
            </a>
          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading">
            <a href="#collapseFour" data-parent="#side_accordion" data-toggle="collapse" class="accordion-toggle">
              <i class="glyphicon glyphicon-cog"></i> Administración
            </a>
          </div>
          <div class="accordion-body collapse" id="collapseFour">
            <div class="panel-body">
              <ul class="nav nav-pills nav-stacked">
                <li><a href="javascript:void(0)">Clientes</a></li>
                <li><a href="javascript:void(0)">Zonas</a></li>
                <li><a href="javascript:void(0)">Hospitales</a></li>
                <li><a href="javascript:void(0)">Localidades</a></li>
                <li><a href="javascript:void(0)">Usuarios</a></li>
              </ul>
            </div>
          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading">
            <a href="#collapseLong" data-parent="#side_accordion" data-toggle="collapse" class="accordion-toggle">
              <i class="glyphicon glyphicon-leaf"></i> PEMEX
            </a>
          </div>
          <div class="accordion-body collapse" id="collapseLong">
              <div class="panel-body">
                <ul class="nav nav-pills nav-stacked">
                  <li><a href="javascript:void(0)">Facturación</a></li>
                  <li><a href="javascript:void(0)">Reporte</a></li>
                </ul>
              </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock sidebar %}

{% block javascript %}
  <script src="{% static "admin/js/jquery.min.js" %}"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>
  <script src="{% static "admin/js/jquery-migrate.min.js" %}"></script>
  <script src="{% static "admin/js/jquery.easing.1.3.min.js" %}"></script>
  <script src="{% static "admin/js/jquery_cookie_min.js" %}"></script>
  <script src="{% static "admin/bootstrap/js/bootstrap.min.js" %}"></script>
  <script src="{% static "admin/js/bootstrap.plugins.min.js" %}"></script>
  <script src="{% static "admin/lib/typeahead/typeahead.min.js" %}"></script>
  <script src="{% static "admin/lib/google-code-prettify/prettify.min.js" %}"></script>
  <script src="{% static "admin/lib/jBreadcrumbs/js/jquery.jBreadCrumb.1.1.min.js" %}"></script>
  <script src="{% static "admin/js/jquery.actual.min.js" %}"></script>
  <script src="{% static "admin/lib/slimScroll/jquery.slimscroll.js" %}"></script>
  <script src="{% static "admin/lib/UItoTop/jquery.ui.totop.min.js" %}"></script>
  <script src="{% static "admin/js/selectNav.js" %}"></script>
  <script src="{% static "admin/js/pages/gebo_common.js" %}"></script>
  <script type="text/javascript" src="{% static "datatables/jquery.dataTables.js" %}"></script>
  <script type="text/javascript" src="{% static "datatables/dataTables.bootstrap.js" %}"></script>
  <script type="text/javascript" src="{% static "datatables/demo-datatables.js" %}"></script>
  <script>
    $('#modal').on('click',function(){
      $('#modal-form').modal('show'); 
    });
    $('#info-claims').on('click',function(){
      $('#modal-info').modal('show'); 
    });
    function motivos(value){
      if(value == 'X'){
        $('#motivo').css('display','block');
      }
    }
  </script>
{% endblock javascript %}

{% block modal %}
<div class="modal fade" id="modal-form" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog" style="z-index:2000;width:90%;">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h4 class="modal-title" id="myModalLabel">Autorizar</h4>
      </div>
      <form action="/claims/" class="form-horizontal" method="POST">{% csrf_token %}
      <div class="modal-body">
        
          <div class="form-group">
             <div class="form-group">
              <label class="col-md-2 control-label">Tipo</label>
              <div class="col-xs-6">
                <div class="input-icon">
                  <select onchange="motivos(this.value);" name="estatus" class="form-control">
                    <option value="A">Aprobar</option>
                    <option value="X">Rechazar</option>
                    <option value="V">A revisión</option>
                  </select>
                </div>
              </div>
            </div>
            <div style="display:none;" id="motivo" class="form-group">
              <label class="col-md-2 control-label">Motivo</label>
              <div class="col-xs-6">
                <div class="input-icon">
                  <select name="motivo" class="form-control">
                    <option value=""></option>
                    {% for item in motivo %}
                      <option value="{{item.id}}">{{item.motivo}}</option>
                    {% endfor %}
                  </select>
                </div>
              </div>
            </div>
            <div class="form-group">
              <label class="col-md-2 control-label">Comentarios</label>
              <div class="col-xs-6">
                <div class="input-icon">
                  <textarea name="descripcion" class="form-control" rows="6" cols="100"></textarea>
                </div>
              </div>
            </div>
          </div>
          <input type="hidden" name="id" value="{{idd}}">
      </div>
      <div id="btnmodal" class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
        <input type="submit" class="btn btn-default" value="Actualizar">
      </div>
      </form>
    </div>
  </div>
</div>
<div class="modal fade" id="modal-info" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog" style="z-index:2000;width:90%;">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h4 class="modal-title" id="myModalLabel">Claims</h4>
      </div>
      <div class="modal-body">
        <table cellpadding="0" cellspacing="0" border="0" class="table table-striped table-bordered datatables" id="tabletools">
                <thead>
                  <tr>
                    <th>Evento</th>
                    <th>Folio Autorización</th>
                    <th>Paciente</th>
                    <th>Tipo</th>
                    <th>Total</th>
                    <th>Ligar</th>
                  </tr>
                </thead>
                <tbody id="tb">
                  {% for dato in autorizacion %}
                    <tr>
                      {% if evento.id == dato.evento_id %}
                        <td>{{evento.numEvento}}</td>
                        <td>{{evento.folioAut}}</td>
                        <td>{{paciente.nombre}}</td>
                        {% if evento.tipo == 'C' %}
                          <td>Cita</td>
                        {% endif %}
                        {% if evento.tipo == 'A' %}
                          <td>Ambulatorio</td>
                        {% endif %}
                        {% if evento.tipo == 'H' %}
                          <td>Hospitalizacion</td>
                        {% endif %}
                        {% if evento.tipo == 'U' %}
                          <td>Urgencia</td>
                        {% endif %}
                        <td>{{evento.total}}</td>
                        <td><input type="checkbox" value=""></td>
                      {% endif %}
                    </tr>
                {% endfor %}
                </tbody>
        </table>
        <div id="btnmodal" class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
          <input type="submit" class="btn btn-default" value="Actualizar">
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock modal %}